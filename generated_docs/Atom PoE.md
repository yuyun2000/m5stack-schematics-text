# Atom PoE 原理图描述

---

## 原理图分析

好的，以下是 M5Stack Atom PoE (SKU: K052) 的原理图技术描述。

### **1. 主要芯片及其功能**

- **以太网控制器 (U1): W5500**
  - **功能**: 该芯片是电路的核心，是一款全硬件 TCP/IP 协议栈的以太网控制器。它内部集成了 MAC (媒体访问控制) 层和 PHY (物理接口) 层，支持 10/100Base-T 以太网。
  - **通信接口**: 通过 SPI (串行外设接口) 与主控制器 (ATOM) 进行数据交换。
  - **电源**: 由 3.3V 电压供电，周围配置了多个去耦电容 (C5, C6, C7, C8, C9, C10) 以确保电源的稳定性。

### **2. 电路设计思想**

该电路旨在为 M5Stack ATOM 系列主控提供一个紧凑的、支持 PoE (Power over Ethernet) 功能的以太网接入方案。设计核心围绕 W5500 芯片，利用其集成的 PHY 和 MAC，通过 SPI 总线与主控通信，实现网络数据的收发。同时，集成的 PoE 模块从网线获取电力，经过转换后为整个模块和 ATOM 主控供电，实现了单根网线解决数据通信和供电的需求。

### **3. 供电与充电电路**

- **PoE 供电模块 (PoE_MODULE)**
  - **输入**: 电力通过 RJ45 接口 (J1) 的空闲线对输入。具体为引脚 4 和 5 (VC-) 与引脚 7 和 8 (VC+)，这符合 IEEE 802.3af/at 的备用线对供电模式 (Mode B)。
  - **保护**: 输入端串联了保险丝 F1 (1.25A) 和一个瞬态抑制二极管 D1，用于过流和过压保护。
  - **功能**: 这是一个隔离型 DC-DC 开关电源模块。它将来自网线的高电压 (通常为 37-57V) 降压并稳压至 5V 输出。其输出 VOUT+ 和 VOUT- 构成了系统的主 5V 电源轨。
- **板载电源转换**
  - **5V 电源轨**: 由 PoE 模块输出或由 ATOM 主控通过 M5_BUS 连接器提供。该 5V 电压直接供给 ATOM 主控的 5V 引脚。
  - **3.3V 稳压电路**: 采用一颗低压差线性稳压器 (LDO) U2 (SPX3819M5-L-3-3)，将 5V 电压转换为 3.3V。输入端和输出端分别配置了电容 C3 和 C4 用于滤波和稳压。
  - **3.3V 电源轨**: 该 3.3V 电压主要为 W5500 以太网控制器 (U1) 供电，并同时提供给 ATOM 主控的 3.3V 引脚。

### **4. 信号路径与电路连接关系**

- **主控接口 (M5_BUS)**
  - **SPI 总线**: ATOM 主控通过其 GPIO 与 W5500 的 SPI 接口连接。
    - `G19` -> `CS` (片选信号) -> U1 的 `SCSn` 引脚。
    - `G22` -> `CLK` (时钟信号) -> U1 的 `SCLK` 引脚。
    - `G23` -> `MISO` (主入从出) -> U1 的 `MISO` 引脚。
    - `G33` -> `MOSI` (主出从入) -> U1 的 `MOSI` 引脚。
  - **控制信号**:
    - `G21` -> `RST` (复位信号) -> U1 的 `RSTn` 引脚。
    - `G25` -> `INT` (中断信号) -> U1 的 `INTn` 引脚。
  - **电源连接**: ATOM 主控的 `5V`、`3V3` 和 `GND` 引脚与模块的对应电源轨直接相连。

- **以太网信号路径**
  - **PHY 到变压器**: W5500 的差分信号输出/输入引脚 (TXP/TXN, RXP/RXN) 连接到网络变压器 T1 (型号 HR911105A) 的芯片侧。
  - **网络变压器 (T1)**: 这是一个集成磁性元件，作用是实现电气隔离、阻抗匹配和共模噪声抑制。
  - **变压器到 RJ45**: 变压器 T1 的线路侧连接到 RJ45 接口 J1 的数据引脚 (1, 2, 3, 6)。
  - **Bob Smith 端接**: T1 的中心抽头通过电容 C11, C12, C13, C14 接地，构成 Bob Smith 端接电路，用于改善 EMI (电磁干扰) 性能。
  - **PHY 偏置**: W5500 的 RXP/RXN 引脚通过 R1 和 R2 两个 49.9Ω 电阻进行偏置。

### **5. 逻辑电路与电平转换**

- **SPI 逻辑**: 通信逻辑电平为 3.3V，由 3.3V 电源轨提供。
- **片选 (CS) 逻辑**: U1 的 `SCSn` (片选) 引脚通过上拉电阻 R7 (10kΩ) 连接到 3.3V。默认状态为高电平，W5500 处于非选中状态。ATOM 主控需将其拉低以启动通信。
- **复位 (RST) 逻辑**: U1 的 `RSTn` (复位) 引脚通过上拉电阻 R6 (10kΩ) 连接到 3.3V。默认状态为高电平，芯片正常工作。ATOM 主控可将其拉低以硬件复位 W5500。
- **中断 (INT) 逻辑**: U1 的 `INTn` (中断) 引脚通过上拉电阻 R8 (10kΩ) 连接到 3.3V。当 W5500 有中断事件时，会主动将此引脚拉低，通知 ATOM 主控。

### **6. 外设模块与接口**

- **RJ45 接口 (J1)**: 标准的 8P8C 以太网母座，集成了网络状态指示灯 (绿色和黄色)。
- **指示灯电路**: J1 的 `LEDA` (黄灯) 和 `LEDB` (绿灯) 分别通过限流电阻 R4 和 R5 (330Ω) 连接到 W5500 的 `LED1` 和 `LED0` 引脚，用于指示网络连接状态和数据活动。
- **ATOM 连接器 (M5_BUS)**: 采用排针/排母接口，用于与 M5Stack ATOM Lite/Matrix 主控进行物理堆叠和电气连接。

---

## 补充信息

好的，以下是对 M5Stack Atom PoE (SKU: K052) 原理图的补充技术描述：

### **7. 补充设计细节**

- **时钟电路 (W5500)**
  - **晶体振荡器 (X1)**: W5500 的时钟由一个外部无源晶体 X1 提供，其频率为 25MHz。
  - **负载电容**: 晶体的 `XI` 和 `XO` 引脚分别通过 C1 和 C2 (18pF) 接地。这两个电容是晶体的负载电容，用于确保振荡器能够稳定起振并工作在正确的频率上，这是以太网 PHY 正常工作的基础。

- **W5500 硬件模式配置**
  - **SPI 模式设置**: W5500 的 `MODE0`, `MODE1`, `MODE2` 引脚通过 R9, R10, R11 (均为 4.7kΩ) 下拉至地。此配置将 W5500 的总线接口永久设置为 "SPI Mode 0"。
  - **PHY 地址配置**: W5500 的 PHY 地址引脚 `P_AD0` 至 `P_AD4` 全部直接接地，将其 PHY 地址设置为 0。

- **电源滤波与去耦**
  - **主电源轨滤波**: 在 PoE 模块的 5V 输出端，放置了一个 10µF 的电容 C15，用于平滑 PoE 模块输出的直流电压。同样，在 3.3V LDO (U2) 的输出端，放置了一个 10µF 的电容 C16，作为该电源轨的输出储能和滤波电容，为 W5500 等负载提供稳定的 3.3V 电源。
  - **芯片级去耦**: W5500 的每个电源引脚（`VDD_3V3`, `PLLVDD`, `BGVDD`）附近都配置了 0.1µF 的高频去耦电容（C5 至 C10），用于滤除高频噪声，保证芯片内部逻辑的稳定运行。

- **未使用的接口**
  - **SMI 接口**: W5500 芯片上的 SMI (Serial Management Interface) 接口引脚 `MDC` 和 `MDIO` 未被连接 (NC)，表明该设计中没有使用独立的管理总线来配置 PHY，所有配置均通过主 SPI 接口完成。

---

*该文档由 AI 自动生成，生成时间: 2025-11-17 19:31:52*
