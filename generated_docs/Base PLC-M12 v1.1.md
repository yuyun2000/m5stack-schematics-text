# Base PLC-M12 v1.1 原理图描述

---

## 原理图分析

### Base PLC-M12 v1.1 原理图描述

#### 1. 供电电路

*   **电源输入**：系统支持 DC 9~24V 宽电压输入。电源可通过两种方式接入：一个 M12-4P 航空插头接口 (J1) 和一个 HT3.96-2P 接线端子 (J2)。两种输入方式并联连接，并通过一个 SS34 肖特基二极管 (D1) 提供防反接保护。
*   **DC-DC 降压电路**：输入电源经过防反接二极管后，进入一个同步降压转换器电路。该电路以 MP1584EN (U1) 为核心芯片，配合一个 10µH 的功率电感 (L1)、续流二极管 (D2) 以及外围的反馈电阻和电容，将 9~24V 的输入电压稳定地降至 5V。
*   **电源输出与分配**：
    *   降压电路输出的 5V 电源，主要供给 M5-BUS 接口的 5V 引脚，为上层连接的 M5Core 主控供电。
    *   该 5V 电源也为板载的 RS485 收发器芯片供电。
    *   原始的 9~24V 输入电源在经过防反接保护后，直接连接到 M5-BUS 接口的 HPWR 引脚，用于向其他可能需要高电压的扩展模块供电。

#### 2. M5-BUS 主接口

该底座通过一个标准的 M5-BUS 接口（排针/排母）与 M5Core 系列主控连接，实现了电源和信号的交互。主要引脚连接关系如下：
*   **GND**：系统主地。
*   **5V**：由底座的 DC-DC 电路产生，向 M5Core 供电。
*   **3V3**：由 M5Core 提供，透传至底座，可用于扩展模块。
*   **BAT**：由 M5Core 的电池提供，透传至底座。
*   **HPWR**：由外部 9~24V 电源直接提供，用于高功率输出。
*   **G16 (RXD)**：连接到 RS485 收发器芯片的数据接收输出引脚 (RO)。
*   **G17 (TXD)**：连接到 RS485 收发器芯片的数据发送输入引脚 (DI)。

#### 3. RS485 通讯电路

*   **核心芯片**：采用一颗 SP3485EN (U2) 或功能兼容的 RS485 半双工收发器芯片，实现 TTL 电平与 RS485 差分信号之间的转换。
*   **信号路径**：
    *   **发送**：来自 M5Core 的串行发送信号 (G17/TXD) 进入 SP3485EN 的 DI 引脚。
    *   **接收**：SP3485EN 的 RO 引脚输出的 TTL 信号连接至 M5Core 的串行接收引脚 (G16/RXD)。
    *   **收发使能**：芯片的驱动器使能引脚 (DE) 和接收器使能引脚 (/RE) 并联在一起，但未连接至 M5Core 的 GPIO，表明该电路可能工作在自动收发模式或固定模式。
*   **差分信号接口**：SP3485EN 的差分输出引脚 A 和 B 连接至一个 HT3.96-3P 接线端子 (J4)，用于连接外部 RS485 总线。端子包含 A、B 和 GND 三个连接点。
*   **总线偏置与终端电阻**：
    *   电路中预留了一个 120Ω 的终端电阻 (R24) 的焊盘，用户可根据需要在总线末端时焊接该电阻。
    *   A、B 信号线上分别设计了上拉和下拉电阻（故障保护偏置电阻），确保总线在空闲状态时具有稳定的差分电压，提高通信可靠性。

#### 4. 外部接口与扩展

*   **M12-4P (J1)**：工业级4针圆形连接器，用于电源输入。Pin 1 接 9-24V，Pin 3 接 GND。
*   **HT3.96-2P (J2)**：2针间距3.96mm的接线端子，作为备用或并联的电源输入。
*   **HT3.96-3P (J4)**：3针间距3.96mm的接线端子，提供 RS485 的 A、B、GND 信号连接。
*   **PLC-Proto 扩展接口 (P1)**：提供了一个 2x10 排针接口，引出了 M5-BUS 上未被使用的 GPIO 引脚以及电源引脚（如 3V3, 5V, GND 等），方便用户焊接 PLC-Proto 原型板或自定义扩展电路。

#### 5. 电路连接关系总结

*   **电源路径**：外部 9~24V 电源通过 J1 或 J2 接口输入，经 D1 防反接后，一路直接送往 M5-BUS 的 HPWR 引脚；另一路经 U1 (MP1584EN) 降压为 5V，为 M5Core 和 RS485 芯片 U2 (SP3485EN) 供电。
*   **RS485 信号路径**：M5Core 的 UART 信号 (G16, G17) 通过 M5-BUS 连接至 U2 的 TTL 侧，U2 将其转换为 RS485 差分信号，并通过 J4 接口输出。反之，从 J4 输入的差分信号经 U2 转换回 TTL 电平后送至 M5Core。
*   **扩展性**：通过 P1 扩展接口，用户可以利用 M5Core 的剩余 I/O 资源，在 PLC-Proto 板上构建自定义的输入/输出电路、继电器控制电路或其他逻辑功能。

---

## 补充信息

好的，基于对原理图的进一步分析，以下是针对电路设计细节的补充说明：

### 补充说明

1.  **电源滤波与稳定性**：
    *   在 MP1584EN 降压转换器的输入和输出端，均配置了电解电容和陶瓷电容。输入端的电容（如 C1, C2）用于滤除输入电源的纹波和提供瞬时大电流，输出端的电容（如 C3, C4）则用于稳定 5V 输出电压，减小输出纹波，确保为 M5Core 和其他芯片提供高质量的电源。

2.  **RS485 收发模式配置**：
    *   RS485 收发器 SP3485EN 的驱动器使能引脚 (DE) 和接收器使能引脚 (/RE) 被连接在一起。电路板上预留了两个电阻位 R22（上拉至5V）和 R23（下拉至GND）。
    *   这是一个硬件配置选项：用户可以通过选择性地焊接 R22 或 R23 来固定收发器的工作模式。焊接 R22 会使收发器始终处于发送使能状态；焊接 R23 则会使其始终处于接收使能状态。该设计未使用 M5Core 的 GPIO 进行动态控制，简化了软件逻辑，但限定了通信为固定模式或需要协议层支持的半双工。

3.  **RS485 总线故障保护偏置**：
    *   为了提高 RS485 总线在空闲或终端断开时的抗干扰能力，电路上设计了故障保护偏置电路（Failsafe Biasing）。通过一个上拉电阻将 A 线拉至高电平，并通过一个下拉电阻将 B 线拉至低电平。这确保了在总线空闲时，A、B 之间存在一个确定的正向差分电压，防止接收器因噪声产生误判。

4.  **M5-BUS 引脚直通设计**：
    *   除了用于 RS485 通信的 G16/G17 和电源引脚外，M5-BUS 上的绝大多数 GPIO 引脚都直接“直通”（Pass-through）连接到了 PLC-Proto 扩展接口 P1 上。这种设计最大化地保留了 M5Core 的 I/O 扩展能力，是实现用户自定义电路的基础。

5.  **物理设计考量**：
    *   电路板上预留了标准的安装孔位，用于将底座固定在外壳或工业导轨（DIN Rail）安装件上。结合使用 M12 航空插头和 HT3.96 这种带螺丝锁紧的接线端子，体现了其面向工业应用场景的加固型设计思想，增强了连接的可靠性和抗振动能力。

---

*该文档由 AI 自动生成，生成时间: 2025-11-17 23:21:42*
