# Unit Weight-I2C 原理图描述

---

## 原理图分析

好的，以下是 M5Stack Unit Weight-I2C (SKU: U180) 的原理图技术描述。

### **1. 主要芯片及其功能**

*   **微控制器 (MCU): STM32F030F4P6**
    *   **功能**: 作为模块的核心控制器，负责与 HX711 芯片进行通信以采集重量数据，处理数据，并通过 I2C 接口将数据作为从设备（Slave）提供给外部主控制器。它还控制板载的状态指示灯。

*   **24位 A/D 转换器: HX711**
    *   **功能**: 一款专为高精度电子秤设计的 24 位模数转换器芯片。其内部集成低噪声可编程增益放大器（PGA），用于放大来自桥式称重传感器（Load Cell）的微弱差分电压信号，并将其转换为数字信号。

### **2. 电路设计思想**

该单元采用“数据采集 + MCU 桥接”的设计架构。HX711 负责模拟信号的精密采集与转换，STM32F030 作为中间处理器，通过模拟 HX711 的串行时序读取数字化的重量数据。随后，STM32F030 将该数据封装并通过标准的 I2C 协议对外提供服务，使主控系统能够便捷地通过 I2C 总线获取重量信息，而无需直接处理 HX711 复杂的通信时序。

### **3. 供电与充电电路**

*   **电源输入**: 电源由外部 HY2.0-4P (Grove) 接口的 5V 引脚和 GND 引脚输入。
*   **电压转换**: 板载一颗 **ME6211 系列**的低压差线性稳压器 (LDO)，将输入的 5V 电压转换为 3.3V。
*   **电源分配**:
    *   **3.3V**: 专用于为 **STM32F030F4P6** 微控制器供电。
    *   **5V**: 直接为 **HX711** 芯片的数字电源（DVDD）和模拟电源（AVDD，通过外部晶体管稳压）供电。
*   **滤波与去耦**:
    *   在 5V 输入端、LDO 的输入和输出端均配置有电解电容和陶瓷电容（如 10μF 和 100nF），用于电源滤波和稳定电压。
    *   在 STM32F030 和 HX711 的电源引脚附近均配置有 100nF 的去耦电容，以滤除高频噪声。

### **4. 信号路径与电路连接关系**

*   **称重传感器信号路径**:
    1.  桥式称重传感器通过 **VH3.96-4P** 连接器接入电路。
    2.  `E+` 和 `E-` 引脚为传感器提供激励电压，该电压由 HX711 的 AVDD 引脚产生。
    3.  传感器输出的差分信号通过 `A+` 和 `A-` 引脚输入到 HX711 的 `INP` 和 `INN` 引脚。输入端配置有 RC 滤波网络以减少噪声干扰。

*   **HX711 与 MCU 的连接**:
    *   HX711 的数据输出引脚 `DT` 连接到 STM32F030 的一个 GPIO 引脚（如 `PA0`）。
    *   HX711 的串行时钟输入引脚 `SCK` 连接到 STM32F030 的另一个 GPIO 引脚（如 `PA1`）。STM32 通过控制这两个引脚的电平来模拟串行通信，读取数据。

*   **MCU 与 I2C 总线的连接**:
    *   STM32F030 的 I2C 时钟引脚 `PB6` (I2C1_SCL) 连接到 Grove 接口的 `SCL` 引脚。
    *   STM32F030 的 I2C 数据引脚 `PB7` (I2C1_SDA) 连接到 Grove 接口的 `SDA` 引脚。
    *   STM32F030 在此电路中作为 I2C 从设备，固定地址为 **0x26**。

### **5. 串口与通讯芯片**

*   **I2C 通讯**: 模块通过 HY2.0-4P Grove 接口对外提供 I2C 通讯。
    *   `SCL` 和 `SDA` 信号线上各连接一个 **4.7kΩ** 的上拉电阻到 **5V** 电源轨。这确保了 I2C 总线在空闲状态时为高电平，并兼容 5V 逻辑电平的主控系统。

*   **编程接口**:
    *   STM32F030 的 `SWDIO` (PA13) 和 `SWCLK` (PA14) 引脚被引出至板上的测试点 (Test Pads)，用于固件的烧录和调试（SWD 协议）。

### **6. 外设模块与逻辑电路**

*   **状态指示灯**:
    *   板载一个蓝色 LED，其负极通过一个限流电阻（如 1kΩ）连接到 STM32F030 的一个 GPIO 引脚。LED 的正极连接到 3.3V 电源。MCU 可通过控制该 GPIO 引脚的电平来点亮或熄灭 LED，用于指示工作状态。

*   **HX711 模拟电源稳压**:
    *   HX711 的模拟电源 `AVDD` 由一个 **PNP 晶体管**（如 S8550）构成的稳压电路提供。该电路受 HX711 内部的参考电压输出引脚 `VBG` 控制，从 5V 输入中为 `AVDD` 和传感器激励电压 `E+` 提供一个稳定的电压源。

### **7. 电平转换**

该电路中不存在独立的电平转换芯片。STM32F030 工作在 3.3V，其 I/O 引脚配置为开漏模式（Open-Drain）并外接上拉电阻到 5V，可以与 5V 逻辑电平的 I2C 总线兼容。与 HX711 的通信接口（DT/SCK）电平由 MCU 和 HX711 的供电电压决定，两者可以直接连接。

---

## 补充信息

好的，在之前描述的基础上，可以补充以下几点技术细节，使原理图描述更加完整：

### **8. 复位与时钟电路**

*   **MCU 复位电路**: STM32F030F4P6 的 `NRST` 引脚通过一个上拉电阻连接到 3.3V 电源，并同时通过一个电容接地。这种 RC 网络构成了标准的上电复位电路，确保 MCU 在上电时能可靠地从一个已知的状态开始运行。
*   **时钟源**:
    *   **MCU 时钟**: 电路中未见外部晶体振荡器。STM32F030F4P6 使用其内部的高速振荡器 (HSI) 作为系统时钟源。这对于该应用场景的性能要求已经足够，并简化了电路设计，降低了成本。
    *   **HX711 时钟**: HX711 芯片同样使用其内部集成的振荡器，无需外部时钟源。

### **9. HX711 特定引脚配置**

*   **数据速率设置 (RATE)**: HX711 的 `RATE` 引脚被直接接地 (GND)。此配置将 HX711 的输出数据速率设置为 **10Hz**。选择较低的速率有助于提高测量结果的稳定性，抑制高频噪声，适合静态或缓慢变化的称重应用。

### **10. 外部接口与连接器**

为了更清晰地定义连接，以下是接口的详细引脚定义：

*   **HY2.0-4P (Grove 接口)**: 用于供电和 I2C 通信。
    *   **Pin 1**: `GND` (地)
    *   **Pin 2**: `5V` (电源输入)
    *   **Pin 3**: `SDA` (I2C 数据线)
    *   **Pin 4**: `SCL` (I2C 时钟线)

*   **VH3.96-4P (称重传感器接口)**: 用于连接外部桥式称重传感器。
    *   **Pin 1**: `E+` (传感器激励电压正)
    *   **Pin 2**: `A+` (差分信号输入正)
    *   **Pin 3**: `A-` (差分信号输入负)
    *   **Pin 4**: `E-` (传感器激励电压负/地)
    *(注意：传感器的颜色线序通常为 红=E+, 黑=E-, 绿=A+, 白=A-，但应以实际传感器规格为准)*

### **11. 电路保护**

*   该单元的电路保护设计较为精简。除了在电源输入端的滤波电容外，没有配置额外的过流保护（如保险丝、PPTC）或专门的静电放电 (ESD) 保护二极管阵列。电路的可靠性主要依赖于前端主控系统供电的稳定性与纯净度。

---

*该文档由 AI 自动生成，生成时间: 2025-11-18 03:07:51*
