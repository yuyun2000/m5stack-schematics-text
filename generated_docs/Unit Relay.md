# Unit Relay 原理图描述

---

## 原理图分析

好的，这是根据您提供的原理图信息生成的 M5Stack Unit Relay 技术描述。

---

### **主要芯片及其功能**

*   **核心元件：HK4100F-DC5V-SHG 继电器**
    *   **类型**：单路单刀双掷（SPDT）电磁继电器。
    *   **功能**：作为电气隔离的开关使用。当其内部线圈通电时，产生磁场驱动机械触点动作，从而接通或断开一个独立的、高功率的外部电路。它实现了低压控制信号（5V）对高压/大电流负载（最高 AC 220V/3A 或 DC 30V/3A）的安全隔离控制。

### **电路设计思想**

该模块的设计核心是利用一个低边开关电路来驱动继电器线圈。由于微控制器（MCU）的 GPIO 引脚驱动能力有限，无法直接提供继电器线圈所需的约 40mA 电流。因此，电路采用一个 NPN 型晶体管作为驱动器。来自主控的 DIN 信号控制晶体管的导通与截止，从而控制流过继电器线圈的电流，实现继电器的吸合与释放。电路中包含了一个续流二极管（反向保护二极管），用于吸收线圈断电时产生的反向电动势，保护驱动晶体管免受损坏。

### **供电电路**

*   **电源输入**：电源由 HY2.0-4P (Grove) 接口的 `5V`（红线）和 `GND`（黑线）引脚提供。
*   **电源路径**：输入的 `5V` 电源直接供给继电器线圈的一端，并作为驱动电路的工作电压。整个模块没有内部的电压转换或稳压电路，完全依赖外部提供的 5V 电源。

### **信号路径**

*   **控制信号输入**：外部控制信号通过 Grove 接口的 `DIN`（黄线）引脚输入。
*   **信号处理**：`DIN` 信号通过一个限流电阻连接到 NPN 晶体管的基极。
    *   当 `DIN` 为高电平（如 3.3V 或 5V）时，晶体管导通。
    *   当 `DIN` 为低电平（0V）时，晶体管截止。
*   **驱动信号输出**：晶体管的导通/截止状态控制了其集电极的电平，从而决定了继电器线圈是否通电。

### **外设模块**

*   **继电器输出端**：模块提供一个三位接线端子，用于连接外部负载电路。
    *   **COM**：公共端。
    *   **ON (NO - Normally Open)**：常开端。继电器未通电时，此端与 COM 断开；通电吸合后，与 COM 闭合。
    *   **OFF (NC - Normally Closed)**：常闭端。继电器未通电时，此端与 COM 闭合；通电吸合后，与 COM 断开。

### **逻辑电路**

*   **驱动电路**：由一个 NPN 晶体管（Q1）、一个基极限流电阻（R1）构成。
    *   **工作逻辑**：当 `DIN` 为高电平，电流经 R1 流入 Q1 基极，使 Q1 饱和导通，其集电极被拉至接近 `GND` 电平，继电器线圈获得 `5V` 工作电压而吸合。当 `DIN` 为低电平，Q1 截止，线圈回路断开，继电器在内部弹簧作用下释放。
*   **保护电路**：一个续流二极管（D1）反向并联在继电器线圈两端。其阴极接 `5V`，阳极接晶体管集电极。当晶体管由导通变为截止时，线圈产生的感应电动势通过此二极管形成续流回路，从而钳位电压，保护晶体管 Q1。
*   **状态指示**：一个 LED 指示灯及其限流电阻（R2）通常与继电器线圈并联。当线圈通电时，LED 点亮，直观显示继电器的工作状态。

### **串口与通讯芯片**

该模块不包含任何串口或专用通讯芯片。它通过单一的数字 GPIO 信号（`DIN`）进行控制。

### **电平转换**

NPN 晶体管驱动电路在此处起到了电流放大和驱动接口的作用，使得低电流驱动能力的 GPIO 信号（如 3.3V/5V）能够可靠地控制需要较大电流（约 40mA）的 5V 继电器线圈。

### **电源管理**

本模块不涉及复杂的电源管理。其功耗直接取决于外部 5V 电源的供给能力。

### **电路之间的连接关系**

1.  **接口与控制电路**：Grove 接口的 `5V` 和 `GND` 为整个电路供电。`DIN` 引脚连接到 NPN 晶体管 Q1 的基极（通过电阻 R1）。`NC` 引脚悬空。
2.  **控制电路与继电器**：Q1 的发射极连接到 `GND`。Q1 的集电极连接到继电器线圈的一端。
3.  **电源与继电器**：继电器线圈的另一端直接连接到 `5V` 电源轨。
4.  **保护与指示**：续流二极管 D1 和状态指示灯 LED1（及串联电阻 R2）均并联在继电器线圈的两端。
5.  **隔离关系**：由继电器线圈和晶体管组成的控制电路，与由继电器内部触点（COM, ON, OFF）组成的负载电路之间是完全电气隔离的。

---

## 补充信息

在以上描述的基础上，可以补充以下几点，使技术描述更加完整和精确：

### **补充说明**

1.  **逻辑极性 (Logic Polarity)**
    *   该电路为 **高电平有效**（Active High）逻辑。即当 `DIN` 输入为高电平时，继电器吸合（ON）；当 `DIN` 输入为低电平时，继电器释放（OFF）。

2.  **电气特性 (Electrical Characteristics)**
    *   **控制电路电压**：5V DC，由 Grove 接口提供。
    *   **控制信号电平**：兼容标准的 3.3V 和 5V TTL/CMOS 逻辑电平。NPN 晶体管的基极驱动电路确保了不同逻辑电平的可靠触发。
    *   **工作电流**：
        *   **待机状态（继电器释放）**：电流消耗极低，仅为晶体管的微安级漏电流。
        *   **工作状态（继电器吸合）**：电流消耗约为 40mA（继电器线圈）加上 LED 指示灯的电流（通常为 5-10mA），总计约 45-50mA @ 5V。

3.  **工作状态总结 (Summary of Operational States)**
    *   **状态一：继电器释放（默认状态）**
        *   **输入**：`DIN` 引脚为低电平。
        *   **驱动**：NPN 晶体管 Q1 截止。
        *   **线圈**：继电器线圈 K1 未通电。
        *   **指示**：LED 指示灯熄灭。
        *   **输出触点**：`COM` 端与 `OFF` (NC) 端导通。
    *   **状态二：继电器吸合（工作状态）**
        *   **输入**：`DIN` 引脚为高电平。
        *   **驱动**：NPN 晶体管 Q1 饱和导通。
        *   **线圈**：5V 电流流过继电器线圈 K1。
        *   **指示**：LED 指示灯点亮。
        *   **输出触点**：`COM` 端与 `ON` (NO) 端导通。

4.  **核心设计要点 (Key Design Point)**
    *   **电气隔离**：该单元最核心的功能是提供了控制侧（M5Stack 主控）与负载侧（外部高压/大电流设备）之间的可靠电气隔离。这种隔离由继电器内部的物理结构实现，确保了主控系统的安全，防止负载侧的电气噪声或高压串扰到低压控制电路。

---

*该文档由 AI 自动生成，生成时间: 2025-11-18 01:51:42*
