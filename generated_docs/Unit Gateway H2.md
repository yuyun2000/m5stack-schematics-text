# Unit Gateway H2 原理图描述

---

## 原理图分析

好的，以下是基于您提供的原理图和提示词，对 Unit Gateway H2 的技术性描述。

### 1. 主控单元 (MCU)

设备的核心控制器是 **ESP32-H2-MINI-1-N2** 模组 (U1)。

*   **供电**：模组的 `VDD33` (Pin 3) 和 `LDO_IN` (Pin 10) 引脚均连接到主 3.3V 电源轨，由 C3 (1μF) 和 C4 (0.1μF) 电容进行电源去耦。
*   **复位与使能**：模组的 `EN` (Pin 4) 引脚通过一个由 R4 (10KΩ) 和 C5 (1μF) 组成的 RC 电路连接到 3.3V 电源。该电路实现上电复位功能，确保芯片在电源稳定后启动。
*   **启动模式**：模组的 `GPIO9` (Pin 19) 通过上拉电阻 R5 (10KΩ) 连接到 3.3V，并与 BOOT 按键 (S1) 相连。当 BOOT 按键被按下时，`GPIO9` 被拉至低电平，使芯片在下次复位时进入下载模式。
*   **USB 接口**：模组的 `GPIO26` (Pin 38) 和 `GPIO27` (Pin 39) 分别与 Type-C 接口的 D+ 和 D- 数据线直连，用于实现 USB 通信和固件烧录。

### 2. 供电与充电电路

*   **电源输入**：系统支持两种 5V 电源输入方式：
    1.  来自 **Type-C 接口 (J1)** 的 VBUS。
    2.  来自 **Grove 接口 (J2)** Pin 2 的 `V_GROVE`。
*   **电源选择与保护**：两个 5V 输入源通过两个肖特基二极管 D1 和 D2 (型号均为 SS14) 进行隔离和或门选择，汇合形成统一的 `5V` 电源轨。这种设计可以防止电流倒灌，并允许任一接口独立为设备供电。
*   **输入滤波**：在 `5V` 电源轨上，使用了一个 10μF 的电容 (C1) 进行滤波。
*   **电压转换**：`5V` 电源轨作为输入，通过一个型号为 **JW5052S** 的同步降压转换器 (U2) 转换成系统所需的 `3V3` 电压。该转换器电路包括：
    *   使能 (EN) 引脚通过电阻 R1 (100KΩ) 连接到输入端，实现上电自启动。
    *   反馈 (FB) 网络由 R2 (100KΩ) 和 R3 (33KΩ) 组成。
    *   开关 (SW) 节点通过一个 2.2μH 的电感 (L1) 连接到输出端。
*   **输出滤波**：在 `3V3` 输出端，使用了一个 22μF 的电容 (C2) 进行滤波，为后级电路提供稳定的 3.3V 电源。

### 3. 信号路径与通讯接口

*   **Grove 接口 (J2 - Port C)**：
    *   **Pin 1**: GND，系统地。
    *   **Pin 2**: `V_GROVE`，5V 电源输入。
    *   **Pin 3**: UART 接收引脚 (从主机角度)，连接到 ESP32-H2 的 `GPIO21` (Pin 33)，即 MCU 的 TXD。
    *   **Pin 4**: UART 发送引脚 (从主机角度)，连接到 ESP32-H2 的 `GPIO20` (Pin 32)，即 MCU 的 RXD。
*   **Type-C 接口 (J1)**：
    *   **功能**：提供电源输入、固件下载和串行调试功能。
    *   **数据连接**：D+ 和 D- 数据线直接连接到 ESP32-H2 模组的 `GPIO26` 和 `GPIO27`，利用了 ESP32-H2 内置的 USB Serial/JTAG 功能。**电路中未使用外部 USB-to-UART 桥接芯片**。
    *   **配置**：CC1 和 CC2 引脚分别通过 5.1KΩ 的下拉电阻 (R6, R7) 接地，用于向 USB 主机声明设备为 UFP (Upstream Facing Port)。

### 4. 射频 (RF) 电路

*   **天线输出**：射频信号由 ESP32-H2 模组的 `ANT` (Pin 11) 引脚输出。
*   **阻抗匹配网络**：信号路径上设计了一个 Pi 型匹配网络，由电容 C7 (1.2pF)、电感 L2 (1.8nH) 和电容 C8 (1.2pF) 组成。该网络用于将模组的射频输出阻抗与板载天线的输入阻抗进行匹配，以优化射频性能。
*   **天线**：匹配网络之后连接到一段特殊设计的 PCB 走线，该走线构成 **板载 PCB 天线**，用于 IEEE 802.15.4 协议的无线通信。

### 5. 控制电路

*   **BOOT 按键 (S1)**：一个常开的瞬时按钮，一端连接到 ESP32-H2 的 `GPIO9`，另一端接地。在设备上电或复位时按住此按钮，可强制芯片进入固件下载模式。

---

## 补充信息

是的，在仔细审阅原理图后，可以补充以下几点关键细节：

### 6. 保护电路

*   **USB ESD 保护**：在 Type-C 接口 (J1) 与主控之间，部署了一颗型号为 **ESDA6V1-5W6** 的 ESD (静电放电) 保护芯片 (U3)。该芯片为 VBUS、D+ 和 D- 线路提供了保护，防止静电或其他瞬态过压损坏 ESP32-H2 模组的 USB 接口。

### 7. 状态指示

*   **可编程 LED**：电路中包含一个状态指示灯 (LED1)，型号为 WS (白色)。该 LED 通过一个 1KΩ 的限流电阻 (R8) 连接在 **GPIO8** (Pin 18) 和 3.3V 电源之间。这意味着当 GPIO8 输出低电平时，LED 点亮。此 LED 可由用户编程，用于指示设备的工作状态、网络连接状态或自定义事件。

### 8. 测试与调试

*   **测试点 (Test Points)**：PCB 上预留了多个测试点，方便生产测试或深度调试。
    *   **TP1**: 连接到 `GPIO8` (LED 控制引脚)。
    *   **TP2**: 连接到 `GPIO9` (BOOT 模式引脚)。
    *   **TP3**: 连接到 `GPIO20` (UART_RXD)。
    *   **TP4**: 连接到 `GPIO21` (UART_TXD)。

---

*该文档由 AI 自动生成，生成时间: 2025-11-18 02:20:24*
