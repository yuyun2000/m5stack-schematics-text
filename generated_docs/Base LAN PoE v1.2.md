# Base LAN PoE v1.2 原理图描述

---

## 原理图分析

### Base LAN PoE v1.2 原理图描述

#### 1. 主要芯片及其功能
- **以太网控制器 (U1)**: 采用 **W5500** 芯片，是一款全硬件 TCP/IP 协议栈的以太网控制器。
  - **功能**: 内置 10/100Base-T 以太网物理层 (PHY) 和 32KB 的收发缓存区，负责处理网络数据包的收发和协议解析。
  - **接口**: 通过 SPI 总线与主控 (M5Stack Core) 通信。

#### 2. 电源系统设计
该模块设计了三种供电路径，通过二极管进行隔离和选择，并经过多级降压为各部分电路供电。

- **供电输入**:
  - **PoE (Power over Ethernet)**: 支持 IEEE 802.3af 标准，通过 RJ45 网口的 4/5 和 7/8 引脚接收 37V-57V 的直流电源。电源经由桥式整流电路 (D1-D4) 处理，以适应不同线序。
  - **外部 DC 输入**: 通过 DC-044 电源插座 (J1) 接受 9V-24V 的直流电源输入。
  - **M5-Bus 输入**: 通过 M-BUS 连接器从 M5Stack 主控获取 5V 电源。

- **电源管理与稳压**:
  - **PoE 降压模块 (PM-1205-B)**: 将来自 PoE 的高压直流电降压至 5V，作为系统主要供电来源之一。
  - **电源选择电路**: 使用肖特基二极管 (D5, D6) 构成一个“或门”电路，自动选择 PoE 模块输出、外部 DC 输入或 M5-Bus 输入中电压最高的一路作为主供电 `V_IN`，同时防止电流倒灌。
  - **第一级降压 (U3)**: 采用 **MP1584EN** 开关降压稳压器，将 `V_IN` 转换为稳定的 5V 电压 (`HPWR` 和 `VCC_5V`)，为 M-BUS 和后级电路供电。
  - **第二级降压 (U2)**: 采用 **SY8089** 降压稳压器，将 `VCC_5V` 进一步降压至 3.3V (`VCC_3V3`)，专门为 W5500 芯片及其外围逻辑电路提供工作电源。

#### 3. 信号路径与电路连接

- **M5-Bus 接口**:
  - **SPI 总线**: W5500 与主控的 SPI 通信信号直接连接到 M-BUS 排针：
    - `MOSI` -> `G23`
    - `MISO` -> `G19`
    - `SCLK` -> `G18`
    - `CS` (片选) -> `G26`
  - **控制信号**:
    - `RSTn` (复位) -> `G13`
    - `INTn` (中断) -> `G34`
  - **UART 信号**: `G5` (RXD0) 和 `G15` (TXD0) 连接至拨码开关，用于选择与扩展串口模块通信。

- **以太网接口**:
  - **RJ45 连接器**: 标准的 8P8C 网络接口，带有 LED 指示灯。
  - **网络变压器 (T1)**: 型号为 **G2401CG**，用于实现物理层与 W5500 芯片之间的电气隔离、信号耦合和阻抗匹配。W5500 的差分发送 (TXOP/TXON) 和接收 (RXIP/RXIN) 引脚通过此变压器连接到 RJ45 端口。

#### 4. 扩展外设与逻辑电路

- **串口扩展接口**:
  - 模块内部预留了用于焊接 RS485、RS232 和 CAN 通信转接板的焊盘。
  - 这些转接板（非标配）上的芯片（如 SP485EEN, MAX232ESE, CA-IS3050G）负责将主控的 TTL 电平信号转换为对应的总线电平。

- **信号切换电路**:
  - **拨码开关 (SW1)**: 一个双刀双掷 (2P2T) 的拨码开关，用于路由主控的 UART 信号 (RXD0/TXD0)。
    - **位置 1**: 将 `G5` 和 `G15` 连接到 `RXD1` 和 `TXD1`，对应 RS485/RS232 扩展焊盘的 TTL 信号路径。
    - **位置 2**: 将 `G5` 和 `G15` 连接到 `RXD2` 和 `TXD2`，对应 CAN 扩展焊盘的 TTL 信号路径。
  - **功能**: 此设计允许用户在不修改硬件的情况下，通过拨动开关选择启用 RS485/RS232 或 CAN 功能中的一种与主控进行通信。

---

## 补充信息

好的，基于前述描述，以下是对 Base LAN PoE v1.2 原理图的补充细节：

### 补充细节

1.  **电源滤波与稳定性**:
    - 在 **MP1584EN (U3)** 和 **SY8089 (U2)** 这两个 DC-DC 降压稳压器的输入和输出端，均配置了电解电容和陶瓷电容。这些电容组成了 LC 滤波网络，主要作用是：
        - **输入端**: 滤除输入电源的纹波和噪声，为稳压器提供一个更稳定的输入。
        - **输出端**: 稳定输出电压，抑制开关稳压器自身产生的高频噪声，并为负载的瞬时电流变化提供缓冲，确保向 W5500 和其他电路提供高质量的 5V 和 3.3V 电源。
    - 在 **W5500 (U1)** 芯片的电源引脚附近，紧密放置了多个去耦电容（通常为 0.1μF 陶瓷电容）。这些电容为芯片提供了一个低阻抗的瞬时电流路径，用于滤除高频噪声，保证芯片内部逻辑的稳定运行。

2.  **信号完整性与默认状态**:
    - **SPI 片选 (CS)**: G26 信号线上拉至 VCC_3V3。此上拉电阻确保在主控未主动操作时，W5500 的片选引脚保持高电平，使芯片处于非选中状态，避免 SPI 总线上的信号干扰。
    - **复位 (RSTn)**: G13 信号线上拉至 VCC_3V3。这保证了在正常工作期间，W5500 的复位引脚处于高电平有效状态。只有当主控将 G13 拉低时，芯片才会被复位。
    - **中断 (INTn)**: G34 信号线上拉至 VCC_3V3。W5500 的中断引脚是开漏 (Open-Drain) 输出，必须通过外部上拉电阻才能输出高电平。当 W5500 产生中断时，它会将该引脚拉低，通知主控处理事件。

3.  **W5500 工作模式配置**:
    - W5500 芯片的 `MODE[0]` 和 `MODE[1]` 引脚通过外部电阻接地。这种配置将 W5500 的物理层 (PHY) 设置为 **全自动协商模式**，使其能够自动检测并适应 10/100 Mbps 的网络速率以及全双工/半双工模式。

4.  **以太网接口保护**:
    - 在 RJ45 连接器和网络变压器 (T1) 之间，通常会配置 ESD (静电放电) 保护器件，例如瞬态电压抑制二极管阵列。这些器件用于吸收来自网线的静电或浪涌，保护后端的 W5500 芯片免受损坏。同时，网络变压器 T1 自身提供了 1.5kV 的电气隔离。

---

*该文档由 AI 自动生成，生成时间: 2025-11-17 19:54:11*
