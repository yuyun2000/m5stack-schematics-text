# Unit PaHub 原理图描述

---

## 原理图分析

### Unit PaHub 原理图描述

#### 1. 整体设计

Unit PaHub 是一款 I2C 总线扩展单元，其电路设计的核心思想是利用 I2C 多路复用器将单个主控 I2C 接口扩展为六个独立的 I2C 通道。这使得主控设备能够与多个具有相同 I2C 地址的从设备进行通信，或简单地增加 I2C 接口的数量。电路结构主要由一个主 I2C 输入接口、一个 I2C 多路复用芯片，以及六个 I2C 输出接口组成。

#### 2. 主要芯片及其功能

*   **芯片型号**: TCA9548A
*   **功能**: 低电压 8 通道 I2C 总线开关/多路复用器。在本设计中，该芯片作为核心控制器，接收主控的 I2C 信号，并根据指令将主 I2C 总线（SDA/SCL）切换连接到八个下行通道中的任意一个（此模块使用了其中的六个通道）。
*   **引脚连接**:
    *   `VCC` (Pin 24): 连接到 5V 电源，为芯片提供工作电压。
    *   `GND` (Pin 13): 连接到电路公共地。
    *   `RESET` (Pin 1): 通过上拉电阻 R1 (10kΩ) 连接到 5V。此引脚为高电平时，芯片正常工作；为低电平时，芯片复位。
    *   `SDA` (Pin 22) / `SCL` (Pin 23): 主 I2C 总线输入引脚，直接连接到主控输入接口 `PORT IN` 的 SDA 和 SCL 信号线。
    *   `A0`, `A1`, `A2` (Pin 2, 3, 4): I2C 地址选择引脚。通过外部电阻 R2, R3, R4 的配置（默认悬空或下拉），决定芯片的 I2C 从设备地址。默认地址为 0x70。
    *   `SDx`/`SCx` (Pairs): 六组从通道 I2C 总线输出引脚，分别连接到六个扩展接口 `PORT0` 至 `PORT5`。

#### 3. 供电电路

*   **电源输入**: 电源由主输入接口 `PORT IN` (J1) 的 5V 引脚提供。
*   **电源分配**:
    *   输入的 5V 电源直接供给 TCA9548A 芯片的 `VCC` 引脚。
    *   同时，5V 电源线和 GND 线被并联分配到所有六个输出接口 (`PORT0` 至 `PORT5`) 的相应引脚上，为连接在这些接口上的外部 I2C 单元供电。
*   **去耦电容**: C1 (0.1μF) 被放置在 TCA9548A 的 VCC 和 GND 引脚之间，用作电源去耦，以确保芯片工作稳定。

#### 4. 信号路径与电路连接关系

*   **主控接口 (PORT IN)**: 型号为 J1，是一个 HY2.0-4P 接口。其 SDA 和 SCL 引脚分别连接到 TCA9548A 的主 I2C 总线引脚 `SDA` (Pin 22) 和 `SCL` (Pin 23)。
*   **I2C 信号路由**: 主控制器通过 `PORT IN` 与 TCA9548A 进行通信。主控首先向 TCA9548A 的 I2C 地址（默认为 0x70）发送指令，写入其内部的控制寄存器，以选择要导通的通道（0-5）。一旦选定，TCA9548A 内部的开关会将主 I2C 总线 (`SDA`/`SCL`) 与所选通道的 I2C 总线 (`SDx`/`SCx`) 电气连接。
*   **扩展接口 (PORT0 - PORT5)**: 六个型号为 J2 至 J7 的 HY2.0-4P 接口，作为扩展输出。其与 TCA9548A 的连接关系如下：
    *   `PORT0` (J2): SDA/SCL 连接到 TCA9548A 的 `SD0`(Pin 14) / `SC0`(Pin 15)。
    *   `PORT1` (J3): SDA/SCL 连接到 TCA9548A 的 `SD1`(Pin 16) / `SC1`(Pin 17)。
    *   `PORT2` (J4): SDA/SCL 连接到 TCA9548A 的 `SD2`(Pin 18) / `SC2`(Pin 19)。
    *   `PORT3` (J5): SDA/SCL 连接到 TCA9548A 的 `SD3`(Pin 20) / `SC3`(Pin 21)。
    *   `PORT4` (J6): SDA/SCL 连接到 TCA9548A 的 `SD4`(Pin 6) / `SC4`(Pin 7)。
    *   `PORT5` (J7): SDA/SCL 连接到 TCA9548A 的 `SD5`(Pin 8) / `SC5`(Pin 9)。

#### 5. 地址配置电路

*   TCA9548A 的 I2C 地址由 `A0`, `A1`, `A2` 三个引脚的电平状态决定，基础地址为 0x70。
*   原理图中预留了三个贴片电阻焊盘 R2, R3, R4，分别对应 `A0`, `A1`, `A2` 引脚。
*   默认状态下，这三个电阻位未焊接，`A0`, `A1`, `A2` 引脚通过内部弱下拉或 PCB 布局被置为低电平 (0)，此时芯片地址为 0x70。
*   用户可以通过在 R2, R3, R4 焊盘上焊接 0Ω 电阻或短接，将对应的地址引脚连接到高电平（VCC），从而改变 I2C 地址。地址范围可从 0x70 到 0x77。

---

## 补充信息

好的，基于已提供的描述，以下是针对 Unit PaHub 原理图的补充技术说明：

### 补充说明

1.  **I2C 上拉电阻**: 原理图中未在主 I2C 总线（SDA/SCL）或任何扩展通道总线（SD0/SC0 至 SD5/SC5）上设置上拉电阻。这表明该模块的设计依赖于外部设备来提供 I2C 上拉功能。具体而言：
    *   主控设备（如 M5Stack Core）需要为其 I2C 总线提供上拉电阻，以确保 `PORT IN` 接口的信号电平正确。
    *   连接到 `PORT0` 至 `PORT5` 扩展接口的从设备单元（Unit）也应自带其 I2C 总线的上拉电阻。TCA9548A 仅作为通道开关，不改变总线的上拉要求。

2.  **未使用的通道**: TCA9548A 芯片本身是一个 8 通道多路复用器，提供 SD0/SC0 到 SD7/SC7 共八组通道。在此设计中，仅使用了其中的 6 个通道（通道 0 至通道 5），并将其引出至物理接口。芯片的通道 6（`SD6`/`SC6`）和通道 7（`SD7`/`SC7`）引脚在 PCB 上未被连接（NC, No Connection）。

3.  **电源直通设计**: 电路中的 5V 供电为直通（Pass-through）设计。输入的 5V 电压未经任何线性稳压器（LDO）或开关电源芯片处理，直接分配给 TCA9548A 芯片和所有六个输出端口。这意味着输出端口的供电电压与输入端口的供电电压完全相同。

4.  **复位电路**: TCA9548A 的 `RESET` 引脚通过一个 10kΩ 的上拉电阻 R1 连接到 5V。这确保了芯片在上电时处于正常工作状态。`RESET` 引脚未被引出到任何接口，仅用于板内复位逻辑。

---

*该文档由 AI 自动生成，生成时间: 2025-11-18 01:36:22*
