# Atomic Motion Base 原理图描述

---

## 原理图分析

好的，这是根据您提供的原理图信息生成的 Atomic Motion Base 技术描述。

---

### **1. 系统概述**
该模块是一个基于 STM32F030F4P6 微控制器（MCU）的运动控制底座。它通过 I2C 接口与上层 ATOM 主控通信，接收指令并驱动外接设备。核心驱动功能由 RZ7899 芯片实现，可控制两路直流电机和四路舵机。系统由可拆卸的锂电池供电，并集成了完整的电源管理电路。

### **2. 主要芯片及其功能**
*   **主控 MCU (U1): STM32F030F4P6**
    *   作为核心控制器，负责处理来自 ATOM 主控的 I2C 指令。
    *   生成四路 PWM 信号，用于精确控制舵机 S1 至 S4。
    *   输出逻辑控制信号至 RZ7899 芯片，以控制两路直流电机的方向和启停。
    *   管理与外部 HY2.0 端口的 GPIO 通信。
*   **电机驱动芯片 (U3): RZ7899**
    *   一个集成的 H 桥电机驱动器。
    *   接收来自 STM32 的四路逻辑输入信号（IN1, IN2, IN3, IN4）。
    *   驱动两路直流电机（M1, M2），实现正转、反转、刹车和停止功能。

### **3. 供电与电源管理电路**
*   **电源输入:**
    *   主电源来自一块可拆卸的 16340 或 18350 锂电池，其电压定义为 **VBAT**。
    *   电池通过物理开关 SW1 控制整个电路的通断。
*   **5V 电源轨:**
    *   VBAT 电压通过一个升压（Boost）转换器电路（U4）生成稳定的 **5V** 电源轨。
    *   输入端配置有滤波电容 C8 和 C9，输出端配置有滤波电容 C10 和 C11，以确保电压稳定。
    *   5V 电源主要为舵机接口、HY2.0-4P 扩展端口以及 3.3V LDO 稳压器供电。
*   **3.3V 电源轨:**
    *   5V 电压通过一个低压差线性稳压器（LDO）U2（型号 662K）降压，生成稳定的 **3.3V** 电源轨。
    *   输入和输出端分别由电容 C6 和 C7 进行滤波。
    *   3.3V 电源专门为 STM32F030F4P6 微控制器（VDD, VDDA）和 I2C 总线的上拉电阻供电。
*   **去耦电容:**
    *   STM32 的 VDD 和 VDDA 引脚旁放置了 100nF 的去耦电容（C1, C2），用于滤除高频噪声。

### **4. MCU 核心与信号路径**
*   **与 ATOM 主控的通信:**
    *   模块通过板载的排针与 ATOM 主控连接。
    *   I2C 通信协议，设备地址为 **0x38**。
    *   ATOM 的 **G21** 引脚连接到 STM32 的 **PB6 (SCL)**。
    *   ATOM 的 **G25** 引脚连接到 STM32 的 **PB7 (SDA)**。
    *   I2C 总线（SCL, SDA）通过电阻 R1 和 R2（10kΩ）上拉至 3.3V。
*   **电机驱动信号路径:**
    *   STM32 的 **PB1** 和 **PA7** 引脚分别连接到 RZ7899 的 IN1 和 IN2，控制直流电机 M1。
    *   STM32 的 **PA6** 和 **PA5** 引脚分别连接到 RZ7899 的 IN3 和 IN4，控制直流电机 M2。
    *   RZ7899 的 VM 引脚直接由 **VBAT** 供电，为其 H 桥提供驱动电流。
*   **舵机驱动信号路径:**
    *   STM32 的 **PA0, PA1, PA2, PA3** 引脚分别生成 PWM 信号，连接至舵机接口 S1, S2, S3, S4 的信号引脚。

### **5. 外设接口与连接关系**
*   **直流电机接口 (M1, M2):**
    *   两个 2.54mm 间距的 2-Pin 接口。
    *   M1 接口连接至 RZ7899 的 OUT1 和 OUT2。
    *   M2 接口连接至 RZ7899 的 OUT3 和 OUT4。
*   **舵机接口 (S1, S2, S3, S4):**
    *   四个 2.54mm 间距的 3-Pin 接口。
    *   引脚定义：GND, **5V**, Signal。
    *   Signal 引脚分别连接至 STM32 的 PA0, PA1, PA2, PA3。
*   **HY2.0-4P 扩展端口:**
    *   提供两路 Grove 兼容接口，用于连接外部传感器或模块。
    *   **PORT.B (黑色):**
        *   Pin 1: SCL (连接至 STM32 PB6)
        *   Pin 2: SDA (连接至 STM32 PB7)
        *   Pin 3: 5V
        *   Pin 4: GND
    *   **PORT.C (蓝色):**
        *   Pin 1: GPIO (连接至 STM32 PA4)
        *   Pin 2: GPIO (连接至 STM32 PB0)
        *   Pin 3: 5V
        *   Pin 4: GND

---

## 补充信息

好的，基于已有的原理图信息，以下是一些补充的技术细节和电路设计考量：

### **6. 补充技术细节**

*   **MCU 复位与启动配置:**
    *   STM32F030F4P6 的 **NRST** 引脚通过一个 10kΩ 电阻上拉至 3.3V，并并联一个 100nF 电容到地。这种 RC 网络确保了在上电时有一个可靠的复位信号。
    *   **BOOT0** 引脚直接接地，这使得 MCU 在每次上电或复位后，默认从内部闪存（Flash Memory）启动，执行预烧录的固件。

*   **程序烧录与调试接口:**
    *   MCU 的 **PA13 (SWDIO)** 和 **PA14 (SWCLK)** 引脚构成了串行线调试（SWD）接口。这些引脚在原理图上通常会引出到测试点（Test Points），用于在生产阶段烧录固件和进行底层硬件调试。

*   **电源域划分:**
    *   **VBAT 域:** 直接由电池供电，电压不稳定（随电池电量变化）。此电源域专门为 RZ7899 电机驱动芯片的功率级（VM 引脚）供电，以提供最大的驱动电流。
    *   **5V 域:** 由升压电路生成，电压稳定。此电源域为所有需要较高电压和较大电流的外部接口供电，包括四路舵机和两路 HY2.0 端口。
    *   **3.3V 域:** 由 LDO 生成，电压稳定，电流较小。此电源域专用于为核心逻辑单元（STM32 MCU）和 I2C 上拉电阻等低功耗数字电路供电，确保其工作稳定不受电机等大功率负载的干扰。

*   **RZ7899 驱动逻辑:**
    *   RZ7899 内部集成了两个 H 桥。对于 M1 电机，STM32 通过控制 IN1 和 IN2 的高低电平组合来实现正转（如 IN1=1, IN2=0）、反转（如 IN1=0, IN2=1）和刹车（如 IN1=1, IN2=1）。M2 电机同理，由 IN3 和 IN4 控制。这种设计简化了电机方向控制的逻辑。
    *   RZ7899 芯片的 VCC 引脚（逻辑电源）很可能也连接到 3.3V，以匹配 STM32 的 I/O 电平。

*   **时钟源:**
    *   原理图中未显示外部晶体振荡器。这表明 STM32F030F4P6 使用其内部的高速 RC 振荡器（HSI）作为主系统时钟。这是一种常见的设计，可以节省成本和 PCB 空间，且其精度足以满足 I2C 通信和 PWM 生成的需求。

---

*该文档由 AI 自动生成，生成时间: 2025-11-17 18:55:17*
