# Atomic Motion Base v1.1 原理图描述

---

## 原理图分析

好的，以下是 Atomic Motion Base v1.1 的原理图技术描述。

### **1. 概述**

Atomic Motion Base v1.1 是一款基于 STM32F030F4P6 微控制器的运动控制底座，设计用于与 ATOM 系列主控配合使用。它集成了直流电机驱动、舵机控制、电池充放电管理、电源监控以及外部设备扩展接口。该模块通过 I2C 总线与主控通信，实现对多路电机的精确控制。

### **2. 主要芯片及其功能**

*   **微控制器 (MCU):** 采用 STMicroelectronics 的 STM32F030F4P6。该 MCU 作为协处理器，负责接收来自 ATOM 主控的 I2C 指令，并生成底座上所有外设的控制信号，包括直流电机驱动信号和四路舵机 PWM 信号。它同时作为 I2C 主机，读取 INA226 电源监控芯片的数据。
*   **直流电机驱动芯片:** 采用 RZ7899。这是一款 H 桥电机驱动芯片，能够驱动两个直流电机。它接收来自 STM32 的逻辑电平信号（M1F/M1R, M2F/M2R），控制电机的正转、反转和停转。
*   **电源管理芯片 (PMU):** 采用 ETA9740。这是一款集成了锂电池充电管理和 5V 同步升压转换功能的高效率电源管理芯片。它负责为 18350 电池充电，并将电池电压升压至稳定的 5V，为整个系统供电。
*   **电源监控芯片:** 采用 INA226。这是一款高精度、支持 I2C 接口的电流、电压和功率监控芯片。它串联在主供电回路上，用于实时监测系统的总线电压、电流消耗和功率，并将数据通过 I2C 总线发送给 STM32 MCU。

### **3. 电路设计思想**

该模块采用主从式架构。ATOM 主控作为系统主控制器，通过 I2C 总线向作为从设备的 STM32 MCU 发送高级指令。STM32 MCU 解析指令后，执行底层的实时控制任务，如生成精确的 PWM 信号驱动舵机，以及控制 RZ7899 驱动直流电机。这种设计将高层逻辑与底层硬件驱动分离，降低了主控的负担。电源部分采用独立的 PMU 进行管理，实现了充电、放电和稳压输出一体化，并通过 INA226 实现了对功耗的闭环监控。

### **4. 供电与充电电路**

*   **电源输入:** 通过与 ATOM 主控连接的接口获取 5V 输入电源，用于给内部电池充电。
*   **电池:** 板载一个可拆卸的 18350 型 900mAh 锂电池作为主能源。
*   **充电管理:** ETA9740 芯片管理整个充电过程，从 5V 输入端获取电力，为 18350 电池提供约 1.152A 的充电电流。
*   **电源输出与稳压:** ETA9740 内置的同步升压电路将锂电池的电压（通常为 3.0V-4.2V）提升并稳定在 5V，作为系统主供电（VCC_5V）。
*   **电源开关:** 电路中包含一个物理电源开关，用于控制电池到 ETA9740 升压电路的通断，从而实现整个模块的硬关机。
*   **电源保护:** 设计有 5V@5A 的过载保护电路，以防止因电机堵转或短路等情况造成的过流损坏。
*   **多电压轨:** 系统主要工作在 5V 电压下。同时，Grove 接口提供了 3.3V 电压输出，该电压由一个未在核心信息中详述的低压差线性稳压器（LDO）从 5V 或电池电压转换而来。

### **5. 信号路径与电路连接关系**

*   **主控与 MCU 通信:** ATOM 主控的 I2C_SCL 和 I2C_SDA 引脚连接至 STM32F030 的相应 I2C 引脚。STM32 在此总线上的 I2C 地址为 0x38。
*   **MCU 到直流电机驱动:** STM32 的 GPIO 引脚分别连接到 RZ7899 的输入引脚，以控制两个电机通道：
    *   `M1F`, `M1R` -> RZ7899 通道1
    *   `M2F`, `M2R` -> RZ7899 通道2
*   **MCU 到舵机接口:** STM32 的四个 GPIO 引脚（PA0, PA1, PA2, PA3）分别配置为 PWM 输出模式，直接连接到四路舵机接口（Servo1, Servo2, Servo3, Servo4）的信号引脚。
*   **MCU 与电源监控:** STM32 通过另一组 I2C 接口作为主机，连接到 INA226 芯片的 SCL 和 SDA 引脚，以读取电源数据。
*   **外设模块（Grove）:** 两路 Grove 接口（HY2.0-4P）的 SCL 和 SDA 引脚并联在 ATOM 主控与 STM32 之间的主 I2C 总线上。同时，接口提供 5V、3.3V 和 GND。

### **6. 串口与通讯芯片**

*   **I2C 通讯:** I2C 总线是本模块的核心通讯方式。
    *   **总线1 (主/从):** 用于 ATOM 主控（主）与 STM32 MCU（从，地址 0x38）之间的通信。该总线也连接到两路 Grove 接口。
    *   **总线2 (MCU 内部):** 用于 STM32 MCU（主）与 INA226 电源监控芯片（从）之间的通信。

---

## 补充信息

好的，基于您提供的原理图信息，以下是更深入和细化的补充描述。

### **7. 接口与连接器 (Interfaces and Connectors)**

*   **直流电机接口:** 提供两路直流电机接口，采用XH2.54规格或类似的端子。每个接口提供两个引脚（如 M1+ / M1-），分别连接到 RZ7899 驱动芯片的输出端 OUT1A/OUT1B 和 OUT2A/OUT2B。
*   **舵机接口:** 提供四路标准 3-Pin 舵机接口。每路接口包括 VCC_5V、GND 和一个信号引脚（Signal）。信号引脚分别连接至 STM32 MCU 的 PA0 (Servo1), PA1 (Servo2), PA2 (Servo3), PA3 (Servo4)。电源引脚直接连接到系统 5V 主供电轨。
*   **Grove 接口:** 板载两路 HY2.0-4P Grove 接口，用于扩展外设。两个接口并联，引脚定义为：
    *   Pin 1: SCL (连接至主 I2C 总线)
    *   Pin 2: SDA (连接至主 I2C 总线)
    *   Pin 3: 5V (来自系统 5V 供电轨)
    *   Pin 4: GND
    *   其中一个或两个接口可能还通过一个额外的 LDO 提供 3.3V 电源选项，但主要总线电压为 5V。
*   **电池座:** 板载一个用于 18350 型锂电池的电池座，包含正负极弹片，支持用户自行更换电池。
*   **ATOM 连接器:** 通过板对板连接器或排针与 ATOM 主控相连，传输 5V 充电电源、GND 以及 I2C 通信信号（SCL, SDA）。

### **8. 电源监控与保护电路的细节**

*   **INA226 测量电路:** INA226 芯片与一个低阻值（通常为毫欧级别）的采样电阻（Shunt Resistor）串联在 ETA9740 的 5V 升压输出端与下游负载（包括所有电机、舵机和 MCU）之间。INA226 通过测量采样电阻两端的微小压降来计算总线电流，同时直接测量总线电压。这样可以精确监控整个系统在 5V 供电轨上的实时功耗。
*   **过载保护:** 5V@5A 的过载保护功能通常由一个可恢复保险丝（PPTC）或专门的过流保护芯片实现，串联在 5V 主供电路径上。当电流超过设定阈值时，它会切断或限制电流，以保护电路；当故障排除后，它能自动恢复。

### **9. MCU 附加功能**

*   **调试接口:** STM32F030F4P6 的 SWD (Serial Wire Debug) 调试引脚，即 SWDIO 和 SWCLK，通常会引出到板上的测试点（Test Pads）。这允许开发者连接 ST-Link 等调试器，对 STM32 协处理器进行固件烧录和在线调试。

### **10. 逻辑电平**

*   **I2C 总线:** ATOM 主控与 STM32 MCU 之间的 I2C 通信总线，以及 Grove 接口上的 I2C 总线，其逻辑电平由主控决定，通常为 3.3V。STM32F030 的 I/O 引脚耐受 5V 电压，因此可以直接与 3.3V 或 5V 系统通信，无需电平转换。
*   **电机驱动信号:** STM32 MCU 输出至 RZ7899 驱动芯片的控制信号为 3.3V CMOS 逻辑电平。RZ7899 的逻辑输入引脚兼容此电平。
*   **舵机信号:** STM32 MCU 输出至舵机的 PWM 信号为 3.3V 逻辑电平，符合大多数舵机信号电平要求。

---

*该文档由 AI 自动生成，生成时间: 2025-11-17 18:54:03*
