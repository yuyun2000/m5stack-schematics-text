# Unit VMeter 原理图描述

---

## 原理图分析

好的，遵照您的指示，以下是 M5Stack Unit VMeter 原理图的详细技术描述。

### M5Stack Unit VMeter 原理图描述

#### 1. 核心功能与设计思想
该电路设计用于实现高精度、电气隔离的直流电压测量，量程为 ±36V。其核心设计思想是通过隔离电源和隔离通讯芯片，将电压采集前端（测量侧）与主控接口端（逻辑侧）进行完全的电气隔离，隔离耐压能力高达 1000 VRMS。电路主要由电压输入与调理、ADC 数据转换、数据与电源隔离、板载数据存储及 Grove 通讯接口五个部分组成。

#### 2. 供电与隔离电源电路
*   **主电源输入**：电路通过 **HY2.0-4P Grove 连接器 (J1)** 的 `5V` 和 `GND` 引脚获取主电源。
*   **电源指示**：板上设有一个 **LED 电源指示灯 (LED1)**，通过一个 1kΩ 的限流电阻 (R1) 连接在 5V 和 GND 之间，用于指示 Grove 接口供电正常。
*   **隔离型 DC/DC 电源模块 (U1)**：此模块是电源隔离的核心。它将输入的 5V 电源转换为一组电气隔离的 5V 电源（标记为 `AVDD`）和隔离地（标记为 `AGND`）。这组隔离电源专门为测量侧的所有芯片（包括 ADC 和 EEPROM）供电，从而实现了电源路径的电气隔离。

#### 3. 电压采集与模拟前端
*   **输入接口**：外部待测电压通过 `VIN` 和 `GND_IN` 端子输入。
*   **分压电路**：为了将 ±36V 的输入电压适配到 ADC 的测量范围内，电路采用了一个由电阻 R5 (100kΩ) 和 R4 (10kΩ) 构成的分压器。输入电压 `VIN` 经过该分压电路后，被衰减为原来的 1/11。
*   **输入保护**：在分压网络的输出端，即 ADC 的输入引脚，并联了肖特基二极管阵列 D1 (BAT54S)。该二极管将 ADC 输入端的电压钳位在 `AGND - V_forward` 和 `AVDD + V_forward` 之间，有效防止输入过压或静电损坏 ADC 芯片。
*   **模拟信号滤波**：电容 C5 (10nF) 与分压电阻构成一个 RC 低通滤波器，用于滤除输入信号中的高频噪声，确保 ADC 输入信号的稳定性。

#### 4. ADC 转换与数据处理
*   **ADC 芯片**：电路的核心是 **ADS1115 (U2)**，这是一款 16 位高精度模数转换器。它负责将经过分压和滤波后的模拟电压信号转换为数字值。
*   **信号连接**：调理后的模拟信号连接到 ADS1115 的 `AIN0` 差分输入正端，`AIN1` 差分输入负端接地 (`AGND`)，构成单端输入模式。
*   **I2C 通讯**：ADS1115 通过 I2C 总线与外部通信。其 I2C 地址由 `ADDR` 引脚的电平决定，在此电路中，其 I2C 地址配置为 **0x49**。

#### 5. 串口通讯与电气隔离
*   **I2C 隔离芯片**：数据路径的隔离由 **CA-IS3020S (U3)** 实现。这是一款 I2C 总线隔离器。
*   **信号路径**：
    *   **逻辑侧 (Side 1)**：`SDA1` 和 `SCL1` 引脚连接到 Grove 接口的 `SDA` 和 `SCL` 信号线。此侧由主控制器的 5V 电源供电。总线上有 R2 和 R3 (均为 2.2kΩ) 作为上拉电阻。
    *   **测量侧 (Side 2)**：`SDA2` 和 `SCL2` 引脚输出隔离后的 I2C 信号（标记为 `SDA_A` 和 `SCL_A`）。此侧由隔离电源模块提供的 `AVDD` 供电。
*   **隔离连接关系**：CA-IS3020S 将逻辑侧的 I2C 总线（连接到 Grove 接口）与测量侧的 I2C 总线（连接到 ADS1115 和 EEPROM）完全隔离，确保即使测量端出现高压，也不会传导至主控设备。

#### 6. 板载存储器
*   **EEPROM 芯片 (U4)**：电路板上集成了一片 **EEPROM** 芯片，用于存储电压测量的校准参数。
*   **连接与地址**：该 EEPROM 连接在测量侧的隔离 I2C 总线 (`SDA_A`, `SCL_A`) 上，与 ADC (ADS1115) 共享总线。其 I2C 地址被配置为 **0x53**。

#### 7. 外部接口
*   **Grove 连接器 (J1)**：作为标准接口，采用 **HY2.0-4P** 规格。引脚定义为：
    1.  `GND`：主地
    2.  `5V`：主电源输入
    3.  `SDA`：I2C 数据线
    4.  `SCL`：I2C 时钟线

#### 总结：电路信号流
1.  外部 ±36V 电压从 `VIN` 输入，通过 R5/R4 分压电路进行衰减。
2.  衰减后的模拟电压信号经 D1 保护和 C5 滤波后，送入 **ADS1115 (U2)** 的 `AIN0` 引脚。
3.  ADS1115 将模拟电压转换为 16 位数字信号。
4.  该数字信号通过隔离的 I2C 总线 (`SDA_A`, `SCL_A`) 进行传输。
5.  **CA-IS3020S (U3)** 接收来自测量侧的 I2C 信号，并将其安全地传输到逻辑侧。
6.  最终，主控设备通过 **Grove 接口 (J1)** 的 `SDA` 和 `SCL` 引脚读取到隔离后的电压数据。
7.  整个测量侧电路（ADS1115, EEPROM, 模拟前端）由 **隔离 DC/DC 模块 (U1)** 独立供电，实现了与主控系统的完全电气隔离。

---

## 补充信息

是的，在先前的描述基础上，可以补充以下几个关键的技术细节，使描述更加完整和深入：

#### 1. I2C 总线上下拉电阻配置
原理图中的 I2C 总线被隔离器 **CA-IS3020S (U3)** 分为两个独立部分，每一部分都配置了必要的上拉电阻以确保总线正常工作：
*   **逻辑侧 (Side 1)**：电阻 R2 和 R3 (均为 2.2kΩ) 将 Grove 接口的 `SDA` 和 `SCL` 信号线分别上拉至 `5V` 电源。这是与主控器通信的标准 I2C 配置。
*   **测量侧 (Side 2)**：电阻 R6 和 R7 (均为 2.2kΩ) 将隔离后的 `SDA_A` 和 `SCL_A` 信号线分别上拉至隔离电源 `AVDD`。这对测量侧总线的正常运行至关重要，因为总线上的设备 **ADS1115 (U2)** 和 **EEPROM (U4)** 都需要外部上拉。

#### 2. 电源去耦电容
为了保证各个芯片供电的稳定性并滤除电源噪声，电路中部署了多个去耦电容：
*   **C1, C2**：为 I2C 隔离芯片 **CA-IS3020S (U3)** 的逻辑侧电源 (VCC1) 提供去耦。
*   **C3, C4**：为 **CA-IS3020S (U3)** 的测量侧电源 (VCC2) 以及隔离电源 `AVDD` 的输出端提供去耦和滤波。
*   **C6**：紧靠 **ADS1115 (U2)** 的电源引脚，为其提供本地电源去耦，对保证 ADC 的转换精度至关重要。
*   **C7**：为 **EEPROM (U4)** 的电源引脚提供去耦，确保其稳定读写。
这些电容的存在是保证电路在高频下稳定可靠运行的关键设计。

#### 3. 分压电路设计考量
分压电路 R5 (100kΩ) 和 R4 (10kΩ) 的设计比例为 10:1，使得总分压比为 `R4 / (R5 + R4) = 10kΩ / (100kΩ + 10kΩ) = 1/11`。
*   **量程匹配**：此设计将 ±36V 的输入电压范围线性映射到 `±36V / 11 ≈ ±3.27V` 的范围内。这个范围完美匹配了 **ADS1115** 在其内部可编程增益放大器 (PGA) 设置下（例如 ±4.096V 档位）的有效输入量程，从而在不饱和的情况下最大化利用 ADC 的分辨率。

#### 4. 未使用的引脚处理
*   在 **ADS1115 (U2)** 芯片上，`ALERT/RDY` 引脚被标记为未连接 (NC)。这意味着硬件设计上没有利用该引脚的转换完成中断或电压比较报警功能。软件在与该设备通信时，需要通过轮询方式查询转换状态或直接读取结果，而不是等待硬件中断信号。

这些补充信息进一步阐明了电路的完整性、稳定性和设计上的具体考量，有助于更深入地理解其工作原理。

---

*该文档由 AI 自动生成，生成时间: 2025-11-18 03:29:44*
